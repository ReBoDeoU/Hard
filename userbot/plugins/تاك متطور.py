import base64
exec(base64.b64decode(b'ZnJvbSB0ZWxldGhvbi50bC50eXBlcyBpbXBvcnQgQ2hhbm5lbFBhcnRpY2lwYW50c0FkbWlucwoKCkBib3Qub24oYWRtaW5fY21kKHBhdHRlcm49Itiq2KfZgyQiKSkKQGJvdC5vbihzdWRvX2NtZChwYXR0ZXJuPSLYqtin2YMkIiwgYWxsb3dfc3Vkbz1UcnVlKSkKYXN5bmMgZGVmIF8oZXZlbnQpOgogICAgaWYgZXZlbnQuZndkX2Zyb206CiAgICAgICAgcmV0dXJuCiAgICByZXBseV90b19pZCA9IGV2ZW50Lm1lc3NhZ2UKICAgIGlmIGV2ZW50LnJlcGx5X3RvX21zZ19pZDoKICAgICAgICByZXBseV90b19pZCA9IGF3YWl0IGV2ZW50LmdldF9yZXBseV9tZXNzYWdlKCkKICAgIG1lbnRpb25zID0gItiq2KfZgyDZhNmE2LfYp9mF2LPZitmGIgogICAgY2hhdCA9IGF3YWl0IGV2ZW50LmdldF9pbnB1dF9jaGF0KCkKICAgIGFzeW5jIGZvciB4IGluIGV2ZW50LmNsaWVudC5pdGVyX3BhcnRpY2lwYW50cyhjaGF0LCAxMDApOgogICAgICAgIG1lbnRpb25zICs9IGYiW1x1MjA2M10odGc6Ly91c2VyP2lkPXt4LmlkfSkiCiAgICBhd2FpdCByZXBseV90b19pZC5yZXBseShtZW50aW9ucykKICAgIGF3YWl0IGV2ZW50LmRlbGV0ZSgpCgoKQGJvdC5vbihhZG1pbl9jbWQocGF0dGVybj0i2YTZhNmD2YQoICguKil8JCkiKSkKQGJvdC5vbihzdWRvX2NtZChwYXR0ZXJuPSLZhNmE2YPZhCggKC4qKXwkKSIsIGFsbG93X3N1ZG89VHJ1ZSkpCmFzeW5jIGRlZiBfKGV2ZW50KToKICAgIGlmIGV2ZW50LmZ3ZF9mcm9tOgogICAgICAgIHJldHVybgogICAgcmVwbHlfdG9faWQgPSBhd2FpdCByZXBseV9pZChldmVudCkKICAgIGlucHV0X3N0ciA9IGV2ZW50LnBhdHRlcm5fbWF0Y2guZ3JvdXAoMSkKICAgIG1lbnRpb25zID0gaW5wdXRfc3RyIG9yICLYqtin2YMg2YTZhNi32KfZhdiz2YrZhiIKICAgIGNoYXQgPSBhd2FpdCBldmVudC5nZXRfaW5wdXRfY2hhdCgpCiAgICBhc3luYyBmb3IgeCBpbiBldmVudC5jbGllbnQuaXRlcl9wYXJ0aWNpcGFudHMoY2hhdCwgMTAwKToKICAgICAgICBtZW50aW9ucyArPSBmIltcdTIwNjNdKHRnOi8vdXNlcj9pZD17eC5pZH0pIgogICAgYXdhaXQgZXZlbnQuY2xpZW50LnNlbmRfbWVzc2FnZShldmVudC5jaGF0X2lkLCBtZW50aW9ucywgcmVwbHlfdG89cmVwbHlfdG9faWQpCiAgICBhd2FpdCBldmVudC5kZWxldGUoKQoKCkBib3Qub24oYWRtaW5fY21kKHBhdHRlcm49Itiq2KfZgyDZhNmE2KfYr9mF2YbZitmHJCIpKQpAYm90Lm9uKHN1ZG9fY21kKHBhdHRlcm49Itiq2KfZgyDZhNmE2KfYr9mF2YbZitmHJCIsIGFsbG93X3N1ZG89VHJ1ZSkpCmFzeW5jIGRlZiBfKGV2ZW50KToKICAgIGlmIGV2ZW50LmZ3ZF9mcm9tOgogICAgICAgIHJldHVybgogICAgbWVudGlvbnMgPSAi8J+SniIKICAgIGNoYXQgPSBhd2FpdCBldmVudC5nZXRfaW5wdXRfY2hhdCgpCiAgICByZXBseV90b19pZCA9IGF3YWl0IHJlcGx5X2lkKGV2ZW50KQogICAgYXN5bmMgZm9yIHggaW4gZXZlbnQuY2xpZW50Lml0ZXJfcGFydGljaXBhbnRzKAogICAgICAgIGNoYXQsIGZpbHRlcj1DaGFubmVsUGFydGljaXBhbnRzQWRtaW5zCiAgICApOgogICAgICAgIGlmIG5vdCB4LmJvdDoKICAgICAgICAgICAgbWVudGlvbnMgKz0gZiJbXHUyMDYzXSh0ZzovL3VzZXI/aWQ9e3guaWR9KSIKICAgIGF3YWl0IGV2ZW50LmNsaWVudC5zZW5kX21lc3NhZ2UoZXZlbnQuY2hhdF9pZCwgbWVudGlvbnMsIHJlcGx5X3RvPXJlcGx5X3RvX2lkKQogICAgYXdhaXQgZXZlbnQuZGVsZXRlKCkKCgpAYm90Lm9uKGFkbWluX2NtZChwYXR0ZXJuPSLZhNmG2YMgKC4qKSIpKQpAYm90Lm9uKHN1ZG9fY21kKHBhdHRlcm49ItmE2YbZgyAoLiopIiwgYWxsb3dfc3Vkbz1UcnVlKSkKYXN5bmMgZGVmIF8oZXZlbnQpOgogICAgaWYgZXZlbnQuZndkX2Zyb206CiAgICAgICAgcmV0dXJuCiAgICBpbnB1dF9zdHIgPSBldmVudC5wYXR0ZXJuX21hdGNoLmdyb3VwKDEpCiAgICByZXBseV90b19pZCA9IGF3YWl0IHJlcGx5X2lkKGV2ZW50KQogICAgaWYgZXZlbnQucmVwbHlfdG9fbXNnX2lkOgogICAgICAgIHJlcGx5X21zZyA9IGF3YWl0IGV2ZW50LmdldF9yZXBseV9tZXNzYWdlKCkKICAgICAgICB1ID0gcmVwbHlfbXNnLnNlbmRlcl9pZAogICAgZWxzZToKICAgICAgICB1c2VyLCBpbnB1dF9zdHIgPSBpbnB1dF9zdHIuc3BsaXQoIiAiLCAxKQogICAgICAgIHRyeToKICAgICAgICAgICAgdSA9IGludCh1c2VyKQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB1ID0gYXdhaXQgZXZlbnQuY2xpZW50LmdldF9lbnRpdHkodXNlcikKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5kZWxldGUoKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHUgPSBpbnQodS5pZCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICBhd2FpdCBldmVudC5kZWxldGUoKQogICAgICAgICAgICByZXR1cm4KICAgIGF3YWl0IGV2ZW50LmRlbGV0ZSgpCiAgICBhd2FpdCBldmVudC5jbGllbnQuc2VuZF9tZXNzYWdlKAogICAgICAgIGV2ZW50LmNoYXRfaWQsCiAgICAgICAgZiI8YSBocmVmPSd0ZzovL3VzZXI/aWQ9e3V9Jz57aW5wdXRfc3RyfTwvYT4iLAogICAgICAgIHBhcnNlX21vZGU9IkhUTUwiLAogICAgICAgIHJlcGx5X3RvPXJlcGx5X3RvX2lkLAogICAgKQoKCkNNRF9IRUxQLnVwZGF0ZSgKICAgIHsKICAgICAgICAibWVudGlvbiI6ICIiIioqUGx1Z2luIDogKipgbWVudGlvbmAKICDigKIgICoqU3ludGF4IDogKipgLmFsbGAKICDigKIgICoqRnVuY3Rpb24gOiAqKl9fdGFncyByZWNlbnQgMTAwIHBlcnNvbnMgaW4gdGhlIGdyb3VwIG1heSBub3Qgd29yayBmb3IgYWxsX18gIAogIOKAoiAgKipTeW50YXggOiAqKmAudGFnYWxsYAogIOKAoiAgKipGdW5jdGlvbiA6ICoqX190YWdzIHJlY2VudCAxMDAgcGVyc29ucyBpbiB0aGUgZ3JvdXAgbWF5IG5vdCB3b3JrIGZvciBhbGxfXyAKICDigKIgICoqU3ludGF4IDogKipgLnJlcG9ydGAKICDigKIgICoqRnVuY3Rpb24gOiAqKl9fdGFncyBhZG1pbnMgaW4gZ3JvdXBfXyAgCiAg4oCiICAqKlN5bnRheCA6ICoqYC5tZW4gdXNlcm5hbWUvdXNlcmlkIHRleHRgCiAg4oCiICAqKkZ1bmN0aW9uIDogKipfX3RhZ3MgdGhhdCBwZXJzb24gd2l0aCB0aGUgZ2l2ZW4gY3VzdG9tIHRleHQgb3RoZXIgd2F5IGZvciB0aGlzIGlzIF9fCiAg4oCiICAqKnN5bnRheCA6ICoqYEhpIHVzZXJuYW1lW2N1c3RvbSB0ZXh0XWAKIiIiCiAgICB9CikKCg=='))
