import base64
exec(base64.b64decode(b'IyDYp9iw2Kcg2KrYrtmF2Lcg2KfYsNmD2LEg2KfZhNit2YLZiNmCINix2KzZgNin2KHYpyAgLQojINmD2KrYp9io2Kkg2YjYqti52K/ZitmEINmI2KrYsdiq2YrYqCAgfiBAREVPT1VTCiMgRm9yIH4gQFJFS0hTTwoKaW1wb3J0IGFzeW5jaW8KaW1wb3J0IGJhc2U2NAppbXBvcnQgb3MKaW1wb3J0IHNodXRpbAppbXBvcnQgdGltZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQoKZnJvbSBQSUwgaW1wb3J0IEltYWdlLCBJbWFnZURyYXcsIEltYWdlRm9udApmcm9tIHB5U21hcnRETCBpbXBvcnQgU21hcnRETApmcm9tIHRlbGV0aG9uLmVycm9ycyBpbXBvcnQgRmxvb2RXYWl0RXJyb3IKZnJvbSB0ZWxldGhvbi50bCBpbXBvcnQgZnVuY3Rpb25zCgpmcm9tIC4uQ29uZmlnIGltcG9ydCBDb25maWcKZnJvbSAuLmhlbHBlcnMudXRpbHMgaW1wb3J0IF9mb3JtYXQKZnJvbSAuLnNxbF9oZWxwZXIuZ2xvYmFscyBpbXBvcnQgYWRkZ3ZhciwgZGVsZ3ZhciwgZ3ZhcnN0YXR1cwpmcm9tIC4gaW1wb3J0IEFVVE9OQU1FLCBERUZBVUxUX0JJTywgZWRpdF9kZWxldGUsIGptdGhvbiwgbG9nZ2luZwoKcGx1Z2luX2NhdGVnb3J5ID0gInRvb2xzIgoKREVGQVVMVFVTRVJCSU8gPSBERUZBVUxUX0JJTyBvciAiINmC2YTZiNio2YbYpyDZhdmE2YrYptipINio2LHYs9in2KbZhCDYjCDZhNmFINiq2YPYqtioICIKREVGQVVMVFVTRVIgPSBBVVRPTkFNRSBvciBDb25maWcuQUxJVkVfTkFNRQpMT0dTID0gbG9nZ2luZy5nZXRMb2dnZXIoX19uYW1lX18pCgpGT05UX0ZJTEVfVE9fVVNFID0gIi91c3Ivc2hhcmUvZm9udHMvdHJ1ZXR5cGUvZGVqYXZ1L0RlamFWdVNhbnNNb25vLnR0ZiIKCmF1dG9waWNfcGF0aCA9IG9zLnBhdGguam9pbihvcy5nZXRjd2QoKSwgInVzZXJib3QiLCAib3JpZ2luYWxfcGljLnBuZyIpCmRpZ2l0YWxwaWNfcGF0aCA9IG9zLnBhdGguam9pbihvcy5nZXRjd2QoKSwgInVzZXJib3QiLCAiZGlnaXRhbF9waWMucG5nIikKYXV0b3Bob3RvX3BhdGggPSBvcy5wYXRoLmpvaW4ob3MuZ2V0Y3dkKCksICJ1c2VyYm90IiwgInBob3RvX3BmcC5wbmciKQoKZGlnaXRhbHBmcCA9IENvbmZpZy5ESUdJVEFMX1BJQyBvciAiaHR0cHM6Ly90ZWxlZ3JhLnBoL2ZpbGUvNDdmZGE1MDMxNmQzZDlhMTY5ZDNlLmpwZyIKUlI3UFAgPSBDb25maWcuVElNRV9KTSBvciAiIgoKbm9ybXpsdGV4dCA9ICIxMjM0NTY3ODkwIgpuYW1lcnpmb250ID0gWwogICAgIvCdn5kiLAogICAgIvCdn5oiLAogICAgIvCdn5siLAogICAgIvCdn5wiLAogICAgIvCdn50iLAogICAgIvCdn54iLAogICAgIvCdn58iLAogICAgIvCdn6AiLAogICAgIvCdn6EiLAogICAgIvCdn5giLApdCgoKYXN5bmMgZGVmIGRpZ2l0YWxwaWNsb29wKCk6CiAgICBESUdJVEFMUElDU1RBUlQgPSBndmFyc3RhdHVzKCJkaWdpdGFscGljIikgPT0gInRydWUiCiAgICBpID0gMAogICAgd2hpbGUgRElHSVRBTFBJQ1NUQVJUOgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhkaWdpdGFscGljX3BhdGgpOgogICAgICAgICAgICBkb3dubG9hZGVyID0gU21hcnRETChkaWdpdGFscGZwLCBkaWdpdGFscGljX3BhdGgsIHByb2dyZXNzX2Jhcj1GYWxzZSkKICAgICAgICAgICAgZG93bmxvYWRlci5zdGFydChibG9ja2luZz1GYWxzZSkKICAgICAgICAgICAgd2hpbGUgbm90IGRvd25sb2FkZXIuaXNGaW5pc2hlZCgpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIHNodXRpbC5jb3B5KGRpZ2l0YWxwaWNfcGF0aCwgYXV0b3Bob3RvX3BhdGgpCiAgICAgICAgSW1hZ2Uub3BlbihhdXRvcGhvdG9fcGF0aCkKICAgICAgICBjdXJyZW50X3RpbWUgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgiJUk6JU0iKQogICAgICAgIGltZyA9IEltYWdlLm9wZW4oYXV0b3Bob3RvX3BhdGgpCiAgICAgICAgZHJhd25fdGV4dCA9IEltYWdlRHJhdy5EcmF3KGltZykKICAgICAgICByb3ogPSBzdHIoYmFzZTY0LmI2NGRlY29kZSgiZFhObGNtSnZkQzlvWld4d1pYSnpMM04wZVd4bGN5OVFZWGxpUVdOckxuUjBaZz09IikpWwogICAgICAgICAgICAyOjM2CiAgICAgICAgXQogICAgICAgIGZudCA9IEltYWdlRm9udC50cnVldHlwZShyb3osIDY1KQogICAgICAgIGRyYXduX3RleHQudGV4dCgoMzAwLCA0MDApLCBjdXJyZW50X3RpbWUsIGZvbnQ9Zm50LCBmaWxsPSgyODAsIDI4MCwgMjgwKSkKICAgICAgICBpbWcuc2F2ZShhdXRvcGhvdG9fcGF0aCkKICAgICAgICBmaWxlID0gYXdhaXQgam10aG9uLnVwbG9hZF9maWxlKGF1dG9waG90b19wYXRoKQogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgaSA+IDA6CiAgICAgICAgICAgICAgICBhd2FpdCBqbXRob24oCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25zLnBob3Rvcy5EZWxldGVQaG90b3NSZXF1ZXN0KAogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBqbXRob24uZ2V0X3Byb2ZpbGVfcGhvdG9zKCJtZSIsIGxpbWl0PTEpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgYXdhaXQgam10aG9uKGZ1bmN0aW9ucy5waG90b3MuVXBsb2FkUHJvZmlsZVBob3RvUmVxdWVzdChmaWxlKSkKICAgICAgICAgICAgb3MucmVtb3ZlKGF1dG9waG90b19wYXRoKQogICAgICAgICAgICBhd2FpdCBhc3luY2lvLnNsZWVwKDYwKQogICAgICAgIGV4Y2VwdCBCYXNlRXhjZXB0aW9uOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBESUdJVEFMUElDU1RBUlQgPSBndmFyc3RhdHVzKCJkaWdpdGFscGljIikgPT0gInRydWUiCgoKYXN5bmMgZGVmIGF1dG9uYW1lX2xvb3AoKToKICAgIEFVVE9OQU1FU1RBUlQgPSBndmFyc3RhdHVzKCJhdXRvbmFtZSIpID09ICJ0cnVlIgogICAgd2hpbGUgQVVUT05BTUVTVEFSVDoKICAgICAgICB0aW1lLnN0cmZ0aW1lKCIlZC0lbS0leSIpCiAgICAgICAgSE0gPSB0aW1lLnN0cmZ0aW1lKCIlSTolTSIpCiAgICAgICAgZm9yIG5vcm1hbCBpbiBITToKICAgICAgICAgICAgaWYgbm9ybWFsIGluIG5vcm16bHRleHQ6CiAgICAgICAgICAgICAgICBuYW1lZm9udCA9IG5hbWVyemZvbnRbbm9ybXpsdGV4dC5pbmRleChub3JtYWwpXQogICAgICAgICAgICAgICAgSE0gPSBITS5yZXBsYWNlKG5vcm1hbCwgbmFtZWZvbnQpCiAgICAgICAgbmFtZSA9IGYie1JSN1BQfSB7SE19IgogICAgICAgIExPR1MuaW5mbyhuYW1lKQogICAgICAgIHRyeToKICAgICAgICAgICAgYXdhaXQgam10aG9uKGZ1bmN0aW9ucy5hY2NvdW50LlVwZGF0ZVByb2ZpbGVSZXF1ZXN0KGZpcnN0X25hbWU9bmFtZSkpCiAgICAgICAgZXhjZXB0IEZsb29kV2FpdEVycm9yIGFzIGV4OgogICAgICAgICAgICBMT0dTLndhcm5pbmcoc3RyKGV4KSkKICAgICAgICAgICAgYXdhaXQgYXN5bmNpby5zbGVlcChleC5zZWNvbmRzKQogICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoQ29uZmlnLkNIQU5HRV9USU1FKQogICAgICAgIEFVVE9OQU1FU1RBUlQgPSBndmFyc3RhdHVzKCJhdXRvbmFtZSIpID09ICJ0cnVlIgoKCmFzeW5jIGRlZiBhdXRvYmlvX2xvb3AoKToKICAgIEFVVE9CSU9TVEFSVCA9IGd2YXJzdGF0dXMoImF1dG9iaW8iKSA9PSAidHJ1ZSIKICAgIHdoaWxlIEFVVE9CSU9TVEFSVDoKICAgICAgICB0aW1lLnN0cmZ0aW1lKCIlZC4lbS4lWSIpCiAgICAgICAgSEkgPSB0aW1lLnN0cmZ0aW1lKCIlSTolTSIpCiAgICAgICAgYmlvID0gZiJ7REVGQVVMVFVTRVJCSU99IHtISX0iCiAgICAgICAgTE9HUy5pbmZvKGJpbykKICAgICAgICB0cnk6CiAgICAgICAgICAgIGF3YWl0IGptdGhvbihmdW5jdGlvbnMuYWNjb3VudC5VcGRhdGVQcm9maWxlUmVxdWVzdChhYm91dD1iaW8pKQogICAgICAgIGV4Y2VwdCBGbG9vZFdhaXRFcnJvciBhcyBleDoKICAgICAgICAgICAgTE9HUy53YXJuaW5nKHN0cihleCkpCiAgICAgICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoZXguc2Vjb25kcykKICAgICAgICBhd2FpdCBhc3luY2lvLnNsZWVwKENvbmZpZy5DSEFOR0VfVElNRSkKICAgICAgICBBVVRPQklPU1RBUlQgPSBndmFyc3RhdHVzKCJhdXRvYmlvIikgPT0gInRydWUiCgoKQGptdGhvbi5hcl9jbWQoCiAgICBwYXR0ZXJuPSLYp9mE2LXZiNix2Kkg2KfZhNmI2YLYqtmK2KkkIiwKICAgIGNvbW1hbmQ9KCLYp9mE2LXZiNix2Kkg2KfZhNmI2YLYqtmK2KkiLCBwbHVnaW5fY2F0ZWdvcnkpLAopCmFzeW5jIGRlZiBfKGV2ZW50KToKICAgICJUbyBzZXQgcmFuZG9tIGNvbG91ciBwaWMgd2l0aCB0aW1lIHRvIHByb2ZpbGUgcGljIgogICAgZG93bmxvYWRlciA9IFNtYXJ0REwoZGlnaXRhbHBmcCwgZGlnaXRhbHBpY19wYXRoLCBwcm9ncmVzc19iYXI9RmFsc2UpCiAgICBkb3dubG9hZGVyLnN0YXJ0KGJsb2NraW5nPUZhbHNlKQogICAgd2hpbGUgbm90IGRvd25sb2FkZXIuaXNGaW5pc2hlZCgpOgogICAgICAgIHBhc3MKICAgIGlmIGd2YXJzdGF0dXMoImRpZ2l0YWxwaWMiKSBpcyBub3QgTm9uZSBhbmQgZ3ZhcnN0YXR1cygiZGlnaXRhbHBpYyIpID09ICJ0cnVlIjoKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICIqKtin2YTYtdmA2YjYsdipINin2YTZgNmI2YLYqtmK2Kkg2LTYutmA2KfZhNipINio2KfZhNij2LXZgNmEIOKZsCoqIikKICAgIGFkZGd2YXIoImRpZ2l0YWxwaWMiLCBUcnVlKQogICAgYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICIqKtiq2YUg2KrZgdmA2LnZitmEINin2YTYtdmA2YjYsdipINin2YTZgNmI2YLYqtmK2Kkg2KjZhtis2YDYp9itIOKZsCoqIikKICAgIGF3YWl0IGRpZ2l0YWxwaWNsb29wKCkKCgpAam10aG9uLmFyX2NtZCgKICAgIHBhdHRlcm49Itin2LPZhSDZiNmC2KrZiiQiLAogICAgY29tbWFuZD0oItin2LPZhSDZiNmC2KrZiiIsIHBsdWdpbl9jYXRlZ29yeSksCikKYXN5bmMgZGVmIF8oZXZlbnQpOgogICAgIlRvIHNldCB5b3VyIGRpc3BsYXkgbmFtZSBhbG9uZyB3aXRoIHRpbWUiCiAgICBpZiBndmFyc3RhdHVzKCJhdXRvbmFtZSIpIGlzIG5vdCBOb25lIGFuZCBndmFyc3RhdHVzKCJhdXRvbmFtZSIpID09ICJ0cnVlIjoKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICIqKtin2YTYp9iz2YDZhSDYp9mE2YDZiNmC2KrZiiDYtNi62YDYp9mEINio2KfZhNij2LXZgNmEIOKZsCoqIikKICAgIGFkZGd2YXIoImF1dG9uYW1lIiwgVHJ1ZSkKICAgIGF3YWl0IGVkaXRfZGVsZXRlKGV2ZW50LCAiKirYqtmFINiq2YHZgNi52YrZhCDYp9mE2KfYs9mA2YUg2KfZhNmA2YjZgtiq2Yog2KjZhtis2YDYp9itIOKZsCoqIikKICAgIGF3YWl0IGF1dG9uYW1lX2xvb3AoKQoKCkBqbXRob24uYXJfY21kKAogICAgcGF0dGVybj0i2KjYp9mK2Ygg2YjZgtiq2YokIiwKICAgIGNvbW1hbmQ9KCLYqNin2YrZiCDZiNmC2KrZiiIsIHBsdWdpbl9jYXRlZ29yeSksCikKYXN5bmMgZGVmIF8oZXZlbnQpOgogICAgIlRvIHVwZGF0ZSB5b3VyIGJpbyBhbG9uZyB3aXRoIHRpbWUiCiAgICBpZiBndmFyc3RhdHVzKCJhdXRvYmlvIikgaXMgbm90IE5vbmUgYW5kIGd2YXJzdGF0dXMoImF1dG9iaW8iKSA9PSAidHJ1ZSI6CiAgICAgICAgcmV0dXJuIGF3YWl0IGVkaXRfZGVsZXRlKGV2ZW50LCAiKirYp9mE2YDYqNin2YrZiCDYp9mE2YDZiNmC2KrZiiDYtNi62YDYp9mEINio2KfZhNij2LXZgNmEIOKZsCoqIikKICAgIGFkZGd2YXIoImF1dG9iaW8iLCBUcnVlKQogICAgYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICIqKtiq2YUg2KrZgdmA2LnZitmEINin2YTYqNmA2KfZitmIINin2YTZgNmI2YLYqtmKINio2YbYrNmA2KfYrSDimbAqKiIpCiAgICBhd2FpdCBhdXRvYmlvX2xvb3AoKQoKCkBqbXRob24uYXJfY21kKAogICAgcGF0dGVybj0i2KfZhtmH2KfYoSAoW1xzXFNdKikiLAogICAgY29tbWFuZD0oItin2YbZh9in2KEiLCBwbHVnaW5fY2F0ZWdvcnkpLAopCmFzeW5jIGRlZiBfKGV2ZW50KTogICMgc291cmNlcnkgbm8tbWV0cmljcwogICAgIlRvIHN0b3AgdGhlIGZ1bmN0aW9ucyBvZiBhdXRvcHJvZmlsZSBwbHVnaW4iCiAgICBpbnB1dF9zdHIgPSBldmVudC5wYXR0ZXJuX21hdGNoLmdyb3VwKDEpCiAgICBpZiBpbnB1dF9zdHIgPT0gItin2YTYtdmI2LHYqSDYp9mE2YjZgtiq2YrYqSI6CiAgICAgICAgaWYgZ3ZhcnN0YXR1cygiZGlnaXRhbHBpYyIpIGlzIG5vdCBOb25lIGFuZCBndmFyc3RhdHVzKCJkaWdpdGFscGljIikgPT0gInRydWUiOgogICAgICAgICAgICBkZWxndmFyKCJkaWdpdGFscGljIikKICAgICAgICAgICAgYXdhaXQgZXZlbnQuY2xpZW50KAogICAgICAgICAgICAgICAgZnVuY3Rpb25zLnBob3Rvcy5EZWxldGVQaG90b3NSZXF1ZXN0KAogICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmNsaWVudC5nZXRfcHJvZmlsZV9waG90b3MoIm1lIiwgbGltaXQ9MSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICIqKtiq2YUg2KfZitmC2KfZgSDYp9mE2LXZiNix2Kkg2KfZhNmI2YLYqtmK2Kkg2KjZhtmA2KzYp9itIOKZsCoqIikKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICIqKtmE2YUg2YrYqtmFINiq2YHYudmK2YQg2KfZhNi12YjYsdipINin2YTZiNmC2KrZitipINio2KfZhNij2LXZhCDimbAqKiIpCiAgICBpZiBpbnB1dF9zdHIgPT0gItin2LPZhSDZiNmC2KrZiiI6CiAgICAgICAgaWYgZ3ZhcnN0YXR1cygiYXV0b25hbWUiKSBpcyBub3QgTm9uZSBhbmQgZ3ZhcnN0YXR1cygiYXV0b25hbWUiKSA9PSAidHJ1ZSI6CiAgICAgICAgICAgIGRlbGd2YXIoImF1dG9uYW1lIikKICAgICAgICAgICAgYXdhaXQgZXZlbnQuY2xpZW50KAogICAgICAgICAgICAgICAgZnVuY3Rpb25zLmFjY291bnQuVXBkYXRlUHJvZmlsZVJlcXVlc3QoZmlyc3RfbmFtZT1ERUZBVUxUVVNFUikKICAgICAgICAgICAgKQogICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICIqKtiq2YUg2KfZitmC2KfZgSAg2KfZhNin2LPZhSDYp9mE2YjZgtiq2Yog2KjZhtmA2KzYp9itIOKZsCoqIikKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICIqKtmE2YUg2YrYqtmFINiq2YHYudmK2YQg2KfZhNin2LPZhSDYp9mE2YjZgtiq2Yog2KjYp9mE2KPYtdmEIOKZsCoqIikKICAgIGlmIGlucHV0X3N0ciA9PSAi2KjYp9mK2Ygg2YjZgtiq2YoiOgogICAgICAgIGlmIGd2YXJzdGF0dXMoImF1dG9iaW8iKSBpcyBub3QgTm9uZSBhbmQgZ3ZhcnN0YXR1cygiYXV0b2JpbyIpID09ICJ0cnVlIjoKICAgICAgICAgICAgZGVsZ3ZhcigiYXV0b2JpbyIpCiAgICAgICAgICAgIGF3YWl0IGV2ZW50LmNsaWVudCgKICAgICAgICAgICAgICAgIGZ1bmN0aW9ucy5hY2NvdW50LlVwZGF0ZVByb2ZpbGVSZXF1ZXN0KGFib3V0PURFRkFVTFRVU0VSQklPKQogICAgICAgICAgICApCiAgICAgICAgICAgIHJldHVybiBhd2FpdCBlZGl0X2RlbGV0ZShldmVudCwgIioqICDYqtmFINin2YrZgtin2YEg2KfZhNio2KfZitmIINin2YTZiNmC2YDYqtmKINio2YbZgNis2KfYrSDimbAqKiIpCiAgICAgICAgcmV0dXJuIGF3YWl0IGVkaXRfZGVsZXRlKGV2ZW50LCAiKirZhNmFINmK2KrZhSDYqtmB2LnZitmEINin2YTYqNin2YrZiCDYp9mE2YjZgtiq2Yog4pmwKioiKQogICAgRU5EX0NNRFMgPSBbCiAgICAgICAgItin2YTYtdmI2LHYqSDYp9mE2YjZgtiq2YrYqSIsCiAgICAgICAgItin2LPZhSDZiNmC2KrZiiIsCiAgICAgICAgItio2KfZitmIINmI2YLYqtmKIiwKICAgIF0KICAgIGlmIGlucHV0X3N0ciBub3QgaW4gRU5EX0NNRFM6CiAgICAgICAgYXdhaXQgZWRpdF9kZWxldGUoCiAgICAgICAgICAgIGV2ZW50LAogICAgICAgICAgICBmIti52YDYsNix2Kcg2YrYrNmA2Kgg2KfYs9iq2YDYrtiv2KfZhSDYp9mE2KfZhdmA2LEg2KjYtNmA2YPZhCDYtdit2YDZititIOKZsCIsCiAgICAgICAgICAgIHBhcnNlX21vZGU9X2Zvcm1hdC5wYXJzZV9wcmUsCiAgICAgICAgKQoKCmptdGhvbi5sb29wLmNyZWF0ZV90YXNrKGRpZ2l0YWxwaWNsb29wKCkpCmptdGhvbi5sb29wLmNyZWF0ZV90YXNrKGF1dG9uYW1lX2xvb3AoKSkKam10aG9uLmxvb3AuY3JlYXRlX3Rhc2soYXV0b2Jpb19sb29wKCkpCg=='))
